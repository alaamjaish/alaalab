<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>التحميلات المجانية - Alaalab</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            base: {
              50:  '#F8FAFC',
              100: '#F1F5F9',
              200: '#E2E8F0',
              300: '#CBD5E1',
              600: '#475569',
              800: '#0F172A'
            },
            primary: {
              50:  '#F0F9FF',
              100: '#E0F2FE',
              500: '#0EA5E9',
              600: '#0284C7',
              700: '#0369A1'
            },
            accent: {
              50:  '#F0FDFA',
              100: '#CCFBF1',
              500: '#14B8A6',
              600: '#0D9488',
              700: '#0F766E'
            }
          },
          fontFamily: {
            arabic: ['Cairo', 'system-ui', 'ui-sans-serif', 'Segoe UI', 'Tahoma', 'sans-serif'],
            english: ['Inter', 'system-ui', 'ui-sans-serif', 'Segoe UI', 'Tahoma', 'sans-serif']
          },
          boxShadow: {
            soft: '0 10px 30px rgba(2, 8, 23, 0.08)'
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Cairo", "Inter", system-ui, -apple-system, Segoe UI, Tahoma, sans-serif;
      background: #FFFFFF;
      color: #0F172A;
      min-height: 100vh;
    }

    .font-english {
      font-family: 'Inter', system-ui, sans-serif;
    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1.25rem;
    }

    .shadow-soft {
      box-shadow: 0 10px 30px rgba(2, 8, 23, 0.08);
    }

    .focus-ring:focus-visible {
      outline: 2px solid #0284C7;
      outline-offset: 2px;
    }

    /* Book Card Hover */
    .book-card {
      transition: transform .25s ease, box-shadow .25s ease;
    }

    .book-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(2,8,23,0.15);
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .modal-content {
      background: white;
      border-radius: 24px;
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.9) translateY(20px);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1) translateY(0);
    }

    /* Form Styles */
    input {
      transition: all 0.3s ease;
    }

    input:focus {
      outline: none;
      border-color: #0284C7;
      box-shadow: 0 0 0 3px rgba(2, 132, 199, 0.1);
    }

    /* Scroll Reveal Animations */
    [data-reveal] {
      opacity: 0;
      transition: opacity .7s cubic-bezier(.2,.7,.2,1), transform .7s cubic-bezier(.2,.7,.2,1);
    }

    [data-reveal="up"] {
      transform: translateY(30px);
    }

    [data-reveal="fade"] {
      transform: none;
    }

    /* Success Animation */
    @keyframes checkmark {
      0% { transform: scale(0) rotate(45deg); }
      50% { transform: scale(1.2) rotate(45deg); }
      100% { transform: scale(1) rotate(45deg); }
    }

    .success-checkmark {
      animation: checkmark 0.5s ease forwards;
    }

    /* Mobile Menu Styles */
    .mobile-menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(4px);
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .mobile-menu-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .mobile-menu-content {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      width: 85%;
      max-width: 400px;
      background: white;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      overflow-y: auto;
    }

    .mobile-menu-overlay.active .mobile-menu-content {
      transform: translateX(0);
    }

    .mobile-menu-link {
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="border-b border-slate-200 backdrop-blur supports-[backdrop-filter]:bg-white/70 bg-white/90 sticky top-0 z-50">
    <nav class="container max-w-7xl flex items-center justify-between py-3">
      <a href="/" class="inline-flex items-center gap-2 hover:opacity-90" aria-label="الصفحة الرئيسية">
        <span class="inline-grid place-items-center w-9 h-9 rounded-xl bg-gradient-to-br from-primary-600 to-accent-600 text-white shadow-soft">
          <span class="font-english font-bold text-sm">AL</span>
        </span>
        <span class="font-bold text-slate-900 text-sm sm:text-base">علاء لاب | لحلول الذكاء الاصطناعي</span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center gap-6 text-sm">
        <a href="/" class="text-slate-700 hover:text-slate-900">أعمالي</a>
        <a href="/" class="text-slate-700 hover:text-slate-900">آلية العمل</a>
        <a href="/" class="text-slate-700 hover:text-slate-900">من أساعد</a>
        <a href="/downloads" class="text-slate-700 hover:text-slate-900 font-bold">التحميلات</a>
        <a href="/" class="px-4 py-2 rounded-xl bg-primary-600 text-white hover:bg-primary-700 transition focus-ring">احجز استشارة</a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobileMenuBtn"
        class="md:hidden w-10 h-10 rounded-lg hover:bg-slate-100 grid place-items-center transition focus-ring"
        aria-label="القائمة"
      >
        <svg class="w-6 h-6 text-slate-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </nav>
  </header>

  <!-- Mobile Menu Overlay -->
  <div id="mobileMenu" class="mobile-menu-overlay">
    <div class="mobile-menu-content">
      <!-- Close Button -->
      <button
        id="closeMobileMenu"
        class="absolute top-4 left-4 w-10 h-10 rounded-lg hover:bg-slate-100 grid place-items-center transition focus-ring"
        aria-label="إغلاق"
      >
        <svg class="w-6 h-6 text-slate-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <!-- Mobile Navigation Links -->
      <nav class="flex flex-col items-center justify-center gap-6 h-full">
        <a href="/" class="mobile-menu-link text-2xl font-bold text-slate-900 hover:text-primary-600 transition">أعمالي</a>
        <a href="/" class="mobile-menu-link text-2xl font-bold text-slate-900 hover:text-primary-600 transition">آلية العمل</a>
        <a href="/" class="mobile-menu-link text-2xl font-bold text-slate-900 hover:text-primary-600 transition">من أساعد</a>
        <a href="/downloads" class="mobile-menu-link text-2xl font-bold text-primary-600 transition">التحميلات</a>
        <a href="/" class="mobile-menu-link px-8 py-4 rounded-xl bg-primary-600 text-white hover:bg-primary-700 transition shadow-soft text-xl font-bold">احجز استشارة</a>
      </nav>
    </div>
  </div>

  <main>
    <!-- Hero Section -->
    <section class="pt-1 pb-8 lg:pt-4 lg:pb-12 bg-gradient-to-b from-slate-50 to-white">
      <div class="container max-w-6xl">
        <div class="text-center mb-8" data-reveal="up">
          <p class="text-xs uppercase tracking-wider text-primary-600 font-english mb-2">Free Resources</p>
          <h1 class="text-2xl lg:text-4xl font-extrabold text-slate-900 mb-3">
            مكتبة الموارد المجانية
          </h1>
          <p class="text-base lg:text-lg text-slate-700 leading-relaxed max-w-2xl mx-auto">
            أدلة وملفات مجانية لمساعدتك في رحلتك مع الذكاء الاصطناعي
          </p>
        </div>

        <!-- Books Gallery -->
        <div id="booksGallery" class="grid md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-5xl mx-auto">
          <!-- Books will be dynamically inserted here -->
        </div>
      </div>
    </section>

    <!-- While You're Here Section -->
    <section class="py-16 lg:py-24 bg-white border-y border-slate-200">
      <div class="container max-w-4xl">
        <div class="text-center mb-12" data-reveal="up">
          <h2 class="text-3xl lg:text-4xl font-extrabold text-slate-900 mb-4">
            بينما أنت هنا...
          </h2>
        </div>

        <div class="space-y-8" data-reveal="up">
          <p class="text-lg text-slate-700 leading-relaxed text-center">
            أنا علاء، أبني حلول ذكاء اصطناعي مخصصة للشركات والمحترفين في العالم العربي.
          </p>
          <p class="text-lg text-slate-700 leading-relaxed text-center">
            إذا كنت تواجه مشاكل في سير عملك وتريد حلاً عملياً - ليس فقط معلومات - أنا هنا لمساعدتك.
          </p>

          <!-- CTA Buttons -->
          <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mt-8">
            <a
              href="https://wa.me/905340718990"
              target="_blank"
              rel="noopener"
              class="px-8 py-4 rounded-xl bg-primary-600 hover:bg-primary-700 text-white transition font-bold shadow-soft focus-ring"
            >
              احجز استشارة مجانية معي
            </a>
            <a
              href="/"
              class="px-8 py-4 rounded-xl border border-slate-300 text-slate-800 hover:bg-slate-50 transition font-semibold focus-ring"
            >
              أو تعرّف أكثر على خدماتي
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="border-t border-slate-200 bg-white py-8">
    <div class="container">
      <div class="text-center text-sm text-slate-600">
        <p>&copy; 2025 Alaalab. جميع الحقوق محفوظة.</p>
      </div>
    </div>
  </footer>

  <!-- Download Modal -->
  <div id="downloadModal" class="modal-overlay">
    <div class="modal-content p-8 lg:p-10">
      <!-- Close Button -->
      <button
        id="closeModal"
        class="absolute top-4 left-4 w-10 h-10 rounded-full hover:bg-slate-100 grid place-items-center transition focus-ring"
        aria-label="إغلاق"
      >
        <svg viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>

      <!-- Form View -->
      <div id="formView">
        <div class="text-center mb-8">
          <div class="w-16 h-16 rounded-full bg-primary-100 grid place-items-center mx-auto mb-4">
            <svg viewBox="0 0 24 24" class="w-8 h-8 text-primary-600" fill="currentColor">
              <path d="M13 2v6h3l-4 5-4-5h3V2z"/>
              <path d="M19 13v6H5v-6H3v8h18v-8z"/>
            </svg>
          </div>
          <h2 class="text-2xl lg:text-3xl font-extrabold text-slate-900 mb-2">
            احصل على المورد المجاني
          </h2>
          <p class="text-slate-700">
            أدخل بريدك الإلكتروني وسنرسل لك رابط التحميل فوراً
          </p>
        </div>

        <form id="downloadForm" class="space-y-5">
          <!-- Name Field -->
          <div>
            <label for="userName" class="block text-sm font-semibold text-slate-900 mb-2">
              الاسم
            </label>
            <input
              type="text"
              id="userName"
              name="name"
              required
              class="w-full px-4 py-3 rounded-xl bg-white border border-slate-300 text-slate-900 placeholder-slate-400 focus-ring"
              placeholder="أدخل اسمك الكامل"
            />
          </div>

          <!-- Email Field -->
          <div>
            <label for="userEmail" class="block text-sm font-semibold text-slate-900 mb-2">
              البريد الإلكتروني
            </label>
            <input
              type="email"
              id="userEmail"
              name="email"
              required
              class="w-full px-4 py-3 rounded-xl bg-white border border-slate-300 text-slate-900 placeholder-slate-400 focus-ring font-english"
              placeholder="your@email.com"
            />
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            id="submitBtn"
            class="w-full px-6 py-4 rounded-xl bg-primary-600 hover:bg-primary-700 text-white transition font-bold text-lg shadow-soft focus-ring"
          >
            تحميل الآن
          </button>

          <p class="text-xs text-slate-600 text-center">
            لن نرسل لك أي رسائل مزعجة. فقط محتوى قيّم.
          </p>
        </form>
      </div>

      <!-- Success View (Hidden by default) -->
      <div id="successView" class="hidden text-center py-6">
        <div class="w-20 h-20 rounded-full bg-accent-100 grid place-items-center mx-auto mb-6">
          <svg viewBox="0 0 24 24" class="w-10 h-10 text-accent-600 success-checkmark" fill="currentColor">
            <path d="M9.55 17.54 4.8 12.8l1.41-1.41 3.34 3.33 7.24-7.24 1.41 1.41z"/>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-slate-900 mb-3">تحقق من بريدك الإلكتروني!</h3>
        <p class="text-lg text-slate-700 mb-6">أرسلنا لك رسالة تحتوي على رابط التحميل. تحقق من صندوق الوارد (أو الرسائل الترويجية)</p>
        <button
          id="closeSuccessBtn"
          class="px-6 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-900 transition font-semibold focus-ring"
        >
          إغلاق
        </button>
      </div>
    </div>
  </div>

  <!-- Load Books Data -->
  <script src="assets/downloads-data.js"></script>

  <script>
    // Global variables
    let currentFormId = '';
    let currentResourceTitle = '';

    // Generate book cards from data
    function renderBooks() {
      const gallery = document.getElementById('booksGallery');

      booksData.forEach(book => {
        const card = document.createElement('div');
        card.className = 'book-card bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-soft';
        card.setAttribute('data-reveal', 'up');

        card.innerHTML = `
          <div class="aspect-[3/4] bg-slate-100 overflow-hidden">
            <img
              src="${book.cover}"
              alt="${book.title}"
              class="w-full h-full object-contain"
            />
          </div>
          <div class="p-4">
            <h3 class="text-base font-bold text-slate-900 mb-2 leading-tight">
              ${book.title}
            </h3>
            <p class="text-slate-600 text-xs mb-3 leading-relaxed">
              ${book.description || ''}
            </p>
            <button
              onclick="openDownloadModal('${book.convertkitFormId}', '${book.title}')"
              class="w-full px-4 py-2 rounded-lg bg-primary-600 hover:bg-primary-700 text-white text-sm transition font-semibold focus-ring"
            >
              تحميل مجاني
            </button>
          </div>
        `;

        gallery.appendChild(card);
      });

      // Trigger reveal animations
      initRevealAnimations();
    }

    // Modal Functions
    function openDownloadModal(formId, resourceTitle) {
      currentFormId = formId;
      currentResourceTitle = resourceTitle;

      // Always show the modal (email required for ConvertKit tracking)
      const modal = document.getElementById('downloadModal');
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeDownloadModal() {
      const modal = document.getElementById('downloadModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';

      // Reset form and views after animation
      setTimeout(() => {
        document.getElementById('formView').classList.remove('hidden');
        document.getElementById('successView').classList.add('hidden');
        document.getElementById('downloadForm').reset();
        document.getElementById('submitBtn').disabled = false;
        document.getElementById('submitBtn').textContent = 'تحميل الآن';
      }, 300);
    }

    // Form Submission Handler
    document.getElementById('downloadForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const name = document.getElementById('userName').value;
      const email = document.getElementById('userEmail').value;
      const submitBtn = document.getElementById('submitBtn');

      // Disable button and show loading
      submitBtn.disabled = true;
      submitBtn.textContent = 'جاري المعالجة...';

      try {
        // Send email to ConvertKit via secure API with form_id
        const response = await fetch('/api/subscribe', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            email: email,
            first_name: name,
            form_id: currentFormId
          })
        });

        const data = await response.json();

        if (response.ok && data.success) {
          // Success! Show email confirmation message
          document.getElementById('formView').classList.add('hidden');
          document.getElementById('successView').classList.remove('hidden');
        } else {
          throw new Error(data.error || 'حدث خطأ');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('حدث خطأ في الإرسال. يرجى المحاولة مرة أخرى.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'تحميل الآن';
      }
    });

    // Close Modal Handlers
    document.getElementById('closeModal').addEventListener('click', closeDownloadModal);
    document.getElementById('closeSuccessBtn').addEventListener('click', closeDownloadModal);

    // Close on overlay click
    document.getElementById('downloadModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeDownloadModal();
      }
    });

    // Close on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeDownloadModal();
      }
    });

    // Scroll Reveal Animation
    function initRevealAnimations() {
      const revealElements = document.querySelectorAll('[data-reveal]');

      revealElements.forEach(el => {
        el.style.transition = 'opacity .7s cubic-bezier(.2,.7,.2,1), transform .7s cubic-bezier(.2,.7,.2,1)';
      });

      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'none';
            io.unobserve(entry.target);
          }
        });
      }, { threshold: 0.16 });

      revealElements.forEach(el => io.observe(el));
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      renderBooks();
    });

    // ==== Mobile Menu
    (function() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const closeMobileMenu = document.getElementById('closeMobileMenu');
      const mobileMenu = document.getElementById('mobileMenu');
      const mobileMenuLinks = document.querySelectorAll('.mobile-menu-link');

      function openMenu() {
        mobileMenu.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeMenu() {
        mobileMenu.classList.remove('active');
        document.body.style.overflow = '';
      }

      // Open menu
      mobileMenuBtn.addEventListener('click', openMenu);

      // Close menu
      closeMobileMenu.addEventListener('click', closeMenu);

      // Close on overlay click
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) closeMenu();
      });

      // Close on link click
      mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
          closeMenu();
        });
      });

      // Close on ESC key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && mobileMenu.classList.contains('active')) {
          closeMenu();
        }
      });
    })();
  </script>
</body>
</html>
